# 3 задание

### Задача заключается в разработке функционала по бронированию, подтверждению заказа и его дальнейшего сохранения в базе данных
## Общая логика работы 

1. Генерация уникального barcode
2. Отправка запроса о резервировании заказа на апи https://api.site.com/book
3. Отправка запроса о потверждении заказа на апи https://api.site.com/approve
4. Сохранение данных в базе данных

### Генерация уникального barcode
За эту часть работы отвечает функция getBarcode().
Основная суть в том чтобы сгенерировать уникальный числовой код. Для этого сохраняется текущее время в микросекундах, генерируется случайной число от 100000 до 999999, а потом убрав раделители значения конкатенируются. Случайное число генерируется для того чтобы придать итоговому числу большую "рандомность".

### Отправка запроса о резервировании заказа на апи https://api.site.com/book
Реального обращения к внешней апи не происходит но это действие имитируется. 
Путём возврата  одного из двух ответов которые могут придти с внешнего сервиса.<br>
Варианты ответов : 
* "message" => "order successfully booked"
* "error" => "barcode already exists"

В случае получения ошибки "barcode already exists" barcode генерируется заново и снова посылается
на внешний сервис.

### Отправка запроса о потверждении заказа на апи https://api.site.com/approve
Реального обращения к внешней апи не происходит но это действие имитируется. 
Путём возврата  одного из двух ответов которые могут придти с внешнего сервиса.<br>
Варианты ответов : 
* "message" => "order successfully approved"
* "error" => "event cancelled"
* "error" => "no tickets"
* "error" => "fan removed".
* "error" => "fan removed"

В случае получения любой из ошибок выводится сообщение о ней и данные в бд не вносятся.
## Сохранение данных в базе данных
Работа с базой данных ведётся при помощи pdo. Используется подготовленное выражение для большей безопасности.
После внесения данных выводится сообщение об успешном резервировании и потверждении заказа.

## Пример работы
* newOrder(1,"2020-11-11",100,1,100,1)
* newOrder(2,"2020-11-11",200,1,100,1)<br>
Результат :<br>
Order was not approved. Error: no seats<br>
Order was successfully booked and approved
